<!doctype html>
<html>
 <head>
  <!--声明当前前页面的编码集：charset-gbk gb2312（中文编码） UTF-8国际编码-->
  <!--当前页面三要素-->
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title></title>
	<!--css 叠层样式-->
	<style type="text/css">
	*{margin:0;padding:0;}
	body{font-size:14px;font-family:"微软雅黑"}
	a{text-decoration:none;color:#333}
	li{list-style:none;}
	#box{width:996px;margin:0 auto;border:1px solid gray;padding:30px 0 0 30px;overflow:hidden;}
	#box li{float:left;margin:0 30px 30px 0;border:1px solid #333;}
	#box li img{width:300px;height:200px;display:block;}




	</style>
 </head>
 <body>
	
	<div id="box">
		<ul id="imgul">
			<li><img data-src="images/1.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/2.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/3.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/4.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/5.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/6.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/1.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/2.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/3.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/4.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/5.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/6.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/1.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/2.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/3.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/4.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/5.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/6.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/1.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/2.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/3.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/4.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/5.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/6.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/1.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/2.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/3.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/4.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/5.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/6.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/1.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/2.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/3.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/4.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/5.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/6.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/1.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/2.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/3.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/4.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/5.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/6.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/1.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/2.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/3.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/4.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/5.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/6.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/1.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/2.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/3.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/4.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/5.jpg" src="images/dtt.jpg"/></li>
			<li><img data-src="images/6.jpg" src="images/dtt.jpg"/></li>

		</ul>
		<div style="clear:both"></div>
	</div>


    <script src="js/Gdom.js"></script>
	<script type="text/javascript">
		window.onload = function(){
			var ulDom = $("imgul");
			var imgDoms = ulDom.getElementsByTagName("img");
			var imgArr = [].slice.call(imgDoms);
			var start = 0;

			showImage();
			window.onscroll = showImage;//滚动加载图片
			function showImage(){
				if(imgArr.length==0)return;
				//获取已滚动的滚动条距离
				var scrollTop = document.body.scrollTop || document.documentElement.scrollTop;
				//获取页面的高度
				var clientHeight = window.innerHeight || document.body.clientHeight;
				
				for(var i=start,len = imgArr.length;i<len;i++){
					//imgDoms.load 还未定义所以是undefined,也就是false那么取反就是true,进入后被改为true，再次循环时取反则为false就不会在进行循环了，这样的做法节约了很多性能，把这!imgDoms.load 段放在最前面优先判断，如果为假后面的条件就不用计算了，同样节约性能！
					if(getTop(imgArr[0])<scrollTop+ clientHeight){
						imgArr[0].src = imgArr[0].getAttribute("data-src");
						imgArr.splice(0,1);//删除后，那么索引0指的就是之前的索引1，所以把每次循环的对象都设为索引0的。
					}
				}
			};
		
			//这种做法既支持浮动布局，也支持定位布局
			function getTop(obj){
				var top = 0;
				while(obj){
					top+=obj.offsetTop;
					obj = obj.offsetParent;//返回最近的父类定位元素，如果定位了，就找到定位的父元素再次循环
				};
				return top;
			};
		
		
		
		
		};
	
	</script>
 </body>
</html>

